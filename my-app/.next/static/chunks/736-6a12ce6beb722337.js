"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[736],{2852:function(e,t,n){n.r(t),n.d(t,{default:function(){return c}});var s=n(5893),i=n(263),l=n.n(i),a=n(7294),r=n(2673),o=n(5829);function c(e){let[t,n]=(0,a.useState)(0),[i,c]=(0,a.useState)(""),[d,u]=(0,a.useState)(""),[m,g]=(0,a.useState)(0),[p,x]=(0,a.useState)(!1),[h,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(""),f=(0,r.D)({mutationFn:e=>o.Z.sendEmail(e),mutationKey:["sendEmailByForgot"]}),N=(0,r.D)({mutationFn:e=>o.Z.verifyCode(e),mutationKey:["verifyCode"]}),C=(0,r.D)({mutationFn:e=>o.Z.resetPassword(e),mutationKey:["resetPassword"]}),S=()=>{if(!i.trim()){alert("請填寫郵箱以獲取驗證碼");return}f.mutate({email:i.trim(),event:"resetpwd"},{onSuccess:()=>{alert("發送驗證碼成功，請到填寫的郵箱内查看驗證碼")},onError:e=>{alert("發送驗證碼失敗")}}),g(60),x(!0)},_=()=>{C.mutate({email:i.trim(),password:h.trim(),confirmPassword:j.trim()},{onSuccess:async t=>{let n=await t.json();n.code?(alert("重置成功"),e.toLogin()):alert(n.msg)},onError:e=>{alert("重置失敗")}})},w=()=>{N.mutate({email:i.trim(),code:d.trim()},{onSuccess:async e=>{let t=await e.json();t.code?n(1):alert(t.msg)},onError:e=>{alert("驗證失敗")}})};return m&&setTimeout(()=>{g(m-1)},1e3),(0,s.jsx)("div",{className:l().login_total,style:{},children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("div",{style:{width:"100%",cursor:"pointer",alignItems:"flex-end",display:"flex",justifyContent:"flex-end"},children:(0,s.jsx)("span",{onClick:()=>{e.close(),n(0)},style:{color:"white"},className:"iconfont",children:""})}),0===t?(0,s.jsxs)("div",{style:{marginTop:"1.5%"},className:l().login_pannel,children:[(0,s.jsx)("div",{style:{letterSpacing:2,fontSize:24},children:"找回密碼"}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsx)("input",{type:"text",placeholder:"電郵/賬戶",onChange:e=>c(e.target.value.trim()),value:i,className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("input",{type:"text",placeholder:"請輸入驗證碼",value:d,onChange:e=>u(e.target.value.trim()),style:{flex:1,marginRight:24},className:l().account_input}),(0,s.jsx)("div",{className:l().send_btn,style:{width:"25%",textAlign:"center"},children:m?(0,s.jsxs)("div",{children:[m,"秒后重新發送"]}):p?(0,s.jsx)("div",{onClick:S,children:"重新發送"}):(0,s.jsx)("div",{onClick:S,children:"獲取驗證碼"})})]})}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsx)("input",{type:"button",onClick:w,className:l().submit_button,value:"提交"})}),(0,s.jsx)("div",{style:{marginTop:"5%",paddingLeft:"3%",display:"flex"},children:(0,s.jsx)("div",{onClick:()=>{n(0),u(""),c(""),e.toLogin()},className:l().changebtn,children:"前往登錄"})})]}):(0,s.jsxs)("div",{style:{marginTop:"1.5%"},className:l().login_pannel,children:[(0,s.jsx)("div",{style:{letterSpacing:2,fontSize:24},children:"重設密碼"}),(0,s.jsx)("div",{style:{marginTop:"2.5%"},children:(0,s.jsx)("input",{type:"password",placeholder:"密碼",value:h,onChange:e=>y(e.target.value),className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"2.5%"},children:(0,s.jsx)("input",{type:"password",placeholder:"确认密碼",value:j,onChange:e=>v(e.target.value),className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"2.5%"},children:(0,s.jsx)("input",{type:"button",onClick:_,className:l().submit_button,value:"提交"})})]})]})})}},3736:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var s=n(5893),i=n(263),l=n.n(i),a=n(7294),r=n(502),o=n(2673),c=n(5829),d=n(1955),u=n(4529),m=n(782);(0,u.ZP)((0,m.tJ)((e,t)=>({user:{},token:"",setUser:t=>{e(e=>({user:t}))},setToken:t=>{e(e=>({token:t}))}}),{name:"user"}));var g=n(1116),p=n(2852);function x(e){let[t,n]=(0,a.useState)(0),[i,u]=(0,a.useState)(0),[m,x]=(0,a.useState)(""),[h,y]=(0,a.useState)(""),[j,v]=(0,a.useState)(!1),[f,N]=(0,a.useState)("login"),C=(0,o.D)({mutationFn:e=>c.Z.sendEmail(e),mutationKey:["sendEmailByLogin"]}),S=(0,o.D)({mutationFn:e=>c.Z.loginByCode(e),mutationKey:["loginByEmail"]}),_=(0,o.D)({mutationFn:e=>c.Z.loginByPassword(e),mutationKey:["loginByPassword"]}),w=()=>{if(!m.trim()){alert("請填寫郵箱以獲取驗證碼");return}C.mutate({email:m.trim(),event:"emaillogin"},{onSuccess:async e=>{let t=await e.json();t.data?alert("發送驗證碼成功，請到填寫的郵箱内查看驗證碼"):alert(t.msg)},onError:e=>{alert("發送驗證碼失敗")}}),u(60),v(!0)},k=()=>{t?S.mutate({email:m.trim(),code:h.trim()},{onSuccess:async t=>{let n=await t.json();n.code?(d.Z.set("token",n.data.token,{expires:1}),e.close(),location.reload()):alert(n.msg)},onError:e=>{alert("登陸失敗")}}):_.mutate({email:m.trim(),password:h.trim()},{onSuccess:async t=>{let n=await t.json();n.code?(d.Z.set("token",n.data.token,{expires:1}),e.close(),location.reload()):alert(n.msg)},onError:e=>{alert("登陸失敗")}})};i&&setTimeout(()=>{u(i-1)},1e3);let T=(0,a.useState)(1200);return(0,a.useEffect)(()=>{T[1](window.innerWidth)},[]),(0,s.jsxs)(r.ZP,{open:e.login,onClose:()=>{e.close(),n(0),N("login")},className:"register"===f?l().register_layout:l().login_layout,width:T[0]>1100?"50%":"90%",children:["login"===f&&(0,s.jsx)(r.ZP.Body,{children:(0,s.jsx)("div",{className:l().login_total,style:{fontSize:"0.9rem"},children:(0,s.jsxs)("div",{className:"",children:[(0,s.jsx)("div",{style:{width:"100%",cursor:"pointer",alignItems:"flex-end",display:"flex",justifyContent:"flex-end"},children:(0,s.jsx)("span",{onClick:()=>{e.close(),n(0)},style:{color:"white"},className:"iconfont",children:""})}),0===t?(0,s.jsxs)("div",{style:{marginTop:"1.5%"},className:l().login_pannel,children:[(0,s.jsx)("div",{style:{fontSize:24,letterSpacing:1},children:"Welcome"}),(0,s.jsx)("div",{style:{marginTop:"0.5%"},children:"你好，欢迎登陆！"}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsx)("input",{type:"text",placeholder:"電郵/賬戶",value:m,onChange:e=>x(e.target.value.trim()),className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsx)("input",{type:"password",placeholder:"密码",value:h,onChange:e=>y(e.target.value.trim()),className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"2.5%",paddingLeft:"3%"},children:(0,s.jsx)("div",{onClick:()=>N("forget"),className:l().forget_password,children:"忘记密码？"})}),(0,s.jsx)("div",{style:{marginTop:"2.5%"},children:(0,s.jsx)("input",{type:"button",onClick:k,className:l().submit_button,value:"登錄"})}),(0,s.jsxs)("div",{style:{marginTop:"5%",paddingLeft:"3%",display:"flex"},children:[(0,s.jsx)("a",{onClick:()=>{N("register"),n(0)},className:l().to_register,children:"前往注冊"}),(0,s.jsx)("div",{onClick:()=>{n(1),y(""),x("")},className:l().changebtn,children:"使用驗證碼登錄"})]})]}):(0,s.jsxs)("div",{style:{marginTop:"1.5%"},className:l().login_pannel,children:[(0,s.jsx)("div",{style:{fontSize:24,letterSpacing:1},children:"Welcome"}),(0,s.jsx)("div",{style:{marginTop:"0.5%"},children:"你好，欢迎登陆！"}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsx)("input",{type:"text",placeholder:"電郵/賬戶",onChange:e=>x(e.target.value.trim()),value:m,className:l().account_input})}),(0,s.jsx)("div",{style:{marginTop:"5%"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,s.jsx)("input",{type:"text",placeholder:"請輸入驗證碼",value:h,onChange:e=>y(e.target.value),style:{flex:1,marginRight:24},className:l().account_input}),(0,s.jsx)("div",{className:l().send_btn,style:{width:"25%",textAlign:"center"},children:i?(0,s.jsxs)("div",{children:[i,"秒后重新發送"]}):j?(0,s.jsx)("div",{onClick:w,children:"重新發送"}):(0,s.jsx)("div",{onClick:w,children:"獲取驗證碼"})})]})}),(0,s.jsx)("div",{style:{marginTop:"2.5%",paddingLeft:"3%"},children:(0,s.jsx)("div",{onClick:()=>N("forget"),className:l().forget_password,children:"忘记密码？"})}),(0,s.jsx)("div",{style:{marginTop:"2.5%"},children:(0,s.jsx)("input",{type:"button",onClick:k,className:l().submit_button,style:{fontSize:18},value:"登錄"})}),(0,s.jsxs)("div",{style:{marginTop:"5%",paddingLeft:"3%",display:"flex"},children:[(0,s.jsx)("a",{onClick:()=>{N("register"),n(0)},className:l().to_register,children:"前往注冊"}),(0,s.jsx)("div",{onClick:()=>{n(0),y(""),x("")},className:l().changebtn,children:"使用密碼登錄"})]})]})]})})}),"register"===f&&(0,s.jsx)(r.ZP.Body,{children:(0,s.jsx)(g.default,{close:()=>{e.close(),n(0),N("login")},toLogin:()=>N("login")})}),"forget"===f&&(0,s.jsx)(r.ZP.Body,{children:(0,s.jsx)(p.default,{close:()=>{e.close(),n(0),N("login")},toLogin:()=>N("login")})})]})}}}]);